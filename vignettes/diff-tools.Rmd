---
title: "Diff Tools"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Diff Tools}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

# Using Diff Functions in `qctools`

This vignette provides detailed documentation and usage examples for the three diff functions in the `qctools` package: `diffPreviousVersions()`, `diffQced()`, and `diffOriginal()`. These functions facilitate the visual comparison of different versions of files within your project, aiding in quality control and code review processes.

## Table of Contents

-   **`gitLog()`**: Retrieves commit information for specified files  
-   **`diffPreviousVersions()`**: Compare two specific versions of a file  
-   **`diffQced()`**: Compare latest version with the most recent QCed version  
-   **`diffOriginal()`**: Compare latest version with the original version  

---

## Prerequisites

Before using the diff functions, ensure that the `qctools` package is installed and loaded.

```r
install.packages("qctools") # If not already installed
library(qctools)
```

---

## `gitLog()`: Retrieves commit information for specified files

The `gitLog()` function retrieves commit information for specified files. It provides the necessary commit hashes for comparing different versions of files.

### Description

Returns a `data.frame` containing the commit hash, last author, and datetime of all commits for the specified files.

### Usage

```r
gitLog(list_of_files, last_rev_only = FALSE)
```

### Examples

#### Retrieve Full Commit History

```r
gitLog("script/data-assembly.R")
```

**Output:**

| file                   | last_commit | last_author    | last_datetime        |
|------------------------|-------------|-----------------|----------------------|
| script/data-assembly.R | abc1234     | Jane Doe        | 2024-11-19 10:00:00  |
| script/data-assembly.R | def5678     | John Smith      | 2024-11-20 12:30:00  |
| script/data-assembly.R | ghi9012     | Alice Johnson   | 2024-11-21 15:45:00  |

#### Retrieve Only the Last Commit

```r
gitLog("script/data-assembly.R", last_rev_only = TRUE)
```

**Output:**

| file                   | last_commit | last_author    | last_datetime        |
|------------------------|-------------|-----------------|----------------------|
| script/data-assembly.R | ghi9012     | Alice Johnson   | 2024-11-21 15:45:00  |

---

## `diffPreviousVersions()`: Compare two specific versions of a file

The `diffPreviousVersions()` function allows you to visually compare two specific versions of a file, highlighting additions, deletions, and modifications.

### Description

Compares two versions of a file. The output appears in the viewer, showing only the rows where there have been additions, deletions, or modifications.

### Usage

```r
diffPreviousVersions(
  file,
  previous_version,
  current_version = NULL,
  banner_cur = NULL,
  banner_prev = NULL,
  side_by_side = TRUE,
  ignore_white_space = FALSE
)
```

### Examples

#### Compare with a Specific Previous Commit

```r
diffPreviousVersions(
  file = "script/data-assembly.R",
  previous_version = "def5678"
)
```

**Output:**

![Dummy Diff Viewer](https://via.placeholder.com/800x400?text=Diff+Viewer+-+Commit+def5678+vs+Current+Version)

*Note: The actual diff viewer will display the differences between commit `def5678` and the current version.*

---

## `diffQced()`: Compare latest version with the most recent QCed version

The `diffQced()` function compares the latest version of a file with the most recent QCed (quality-controlled) version, highlighting any changes that need re-evaluation.

### Description

Compares the latest version of a file with the most recent QCed version. The output appears in the viewer, showing only the rows where there have been additions, deletions, or modifications.

### Usage

```r
diffQced(file, side_by_side = TRUE, ignore_white_space = FALSE)
```

### Examples

#### Compare with the Last QCed Version

```r
diffQced("script/data-assembly.R")
```

**Output:**

![Dummy QCed Diff Viewer](https://via.placeholder.com/800x400?text=Diff+Viewer+-+QCed+Version+vs+Current+Version)

*Note: The actual diff viewer will display the differences between the QCed version and the current version.*

---

## `diffOriginal()`: Compare latest version with the original version

The `diffOriginal()` function allows you to compare the latest version of a file with its original version when it was first checked into the repository.

### Description

Compares the latest version of a file to the initial version checked into the repository. The output appears in the viewer, showing only the rows where there have been additions, deletions, or modifications.

### Usage

```r
diffOriginal(file, side_by_side = TRUE, ignore_white_space = FALSE)
```

### Examples

#### Compare with the Original Version

```r
diffOriginal("script/data-assembly.R")
```

**Output:**

![Dummy Original Diff Viewer](https://via.placeholder.com/800x400?text=Diff+Viewer+-+Original+Version+vs+Current+Version)

*Note: The actual diff viewer will display the differences between the original version and the current version.*

---

# Additional Notes

- **Dummy Outputs**: The images used in the examples are placeholders. In actual documentation, these would be replaced by screenshots or rendered outputs from the diff viewer.

- **Error Handling**: The functions include error handling to notify users when files are not found in the QC log or when there are no differences to display.

- **Customization**: Users can customize the display of diffs by adjusting the `side_by_side` and `ignore_white_space` parameters as needed.

# References

- [qctools GitHub Repository](https://github.com/metrumresearchgroup/qctools/issues)

For further assistance or to report bugs, please refer to the [issues page](https://github.com/metrumresearchgroup/qctools/issues) of the `qctools` GitHub repository.

# License

This package is released under the MIT License.

# Acknowledgments

The development of `qctools` was supported by contributions from the open-source community and the Metrum Research Group.

# Contact

For any questions or feedback, please contact the package maintainer at [email@example.com](mailto:email@example.com).

# Example Project Structure

```
project/
│
├── script/
│   ├── analysis.R
│   ├── data-prep.R
│   ├── model-fitting.R
│   └── visualize.R
│
├── QClog.csv
│
├── README.md
│
└── ... (other project files)
```

Ensure that your project follows a similar structure to leverage the full capabilities of `qctools`.

---

*This vignette was generated to assist users in effectively utilizing the diff functions within the `qctools` package for robust quality control and version management.*
